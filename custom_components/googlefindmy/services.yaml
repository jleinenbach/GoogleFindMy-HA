# custom_components/googlefindmy/services.yaml
# Purpose: Service descriptions aligned 1:1 with integration handlers in __init__.py
# Notes:
# - We keep a REQUIRED `device_id` field so handlers have a stable input.
# - Target uses **entity filter only** (domain + integration) for HA 2025.5+.
#   Do not add `target.device` or `target.area`; entity filters are applied across UI.
# - Error strings are translated by handlers via ServiceValidationError.
# - When adding services or fields, sync the README services table so schema + docs stay aligned.

locate_device:
  name: Locate Device
  description: "Get the current location of a Google Find My device."
  target:
    entity:
      domain: device_tracker
      integration: googlefindmy
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass a canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy

play_sound:
  name: Play Sound
  description: "Play a sound on a Google Find My device."
  target:
    entity:
      domain: device_tracker
      integration: googlefindmy
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass a canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy

stop_sound:
  name: Stop Sound
  description: "Stop the sound on a Google Find My device."
  target:
    entity:
      domain: device_tracker
      integration: googlefindmy
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass a canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy

locate_external:
  name: Locate Device (External)
  description: "Locate a device using the external helper; delegates to the normal locate operation."
  target:
    entity:
      domain: device_tracker
      integration: googlefindmy
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass a canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy
    device_name:
      name: Device Name (optional)
      description: "An optional human-readable name for logging."
      example: "Keys Tracker"
      required: false
      selector:
        text:

refresh_device_urls:
  name: Refresh Device URLs
  description: "Refresh the configuration URLs for Google Find My devices to point to the integrated map view."

rebuild_registry:
  name: Rebuild / Migrate Registry
  description: "Maintenance: Run targeted migrations (data→options, unique IDs, button relinking) or rebuild entities/devices for this integration."
  fields:
    mode:
      name: Mode
      description: "Choose 'Rebuild' to remove entities/devices and reload; 'Migrate' reapplies data→options, unique ID, and button relinking migrations."
      required: false
      default: rebuild
      selector:
        select:
          options:
            - label: Rebuild (remove + reload)
              value: rebuild
            - label: Migrate (data→options + unique IDs + buttons)
              value: migrate
    device_ids:
      name: Devices (optional)
      description: "Limit the operation to specific devices. Leave empty to target all Google Find My devices."
      required: false
      selector:
        device:
          multiple: true
          integration: googlefindmy
    entry_id:
      name: Config Entry IDs (optional)
      description: >-
        Target specific config entries when reloading. Accepts either a single entry_id string
        (`entry_id: "abc123def456"`) or a list of IDs (`entry_id: ["abc123def456", "ghi789jkl012"]`).
      required: false
      example:
        - "abc123def456"
        - "ghi789jkl012"
      selector:
        text:
          multiline: false

# custom_components/googlefindmy/services.yaml
# Purpose: Service descriptions aligned 1:1 with integration handlers in __init__.py
# Notes:
# - Each device-scoped service offers a broad `target` (entities from domain `device_tracker`
#   plus optional device/area) to improve UI selection. For backend compatibility, a
#   dedicated `device_id` field remains REQUIRED and is used by the handlers.
# - Error messages are not hard-coded here; handlers raise translated exceptions
#   via `ServiceValidationError` (see translations/*).
#

locate_device:
  name: Locate Device
  description: "Request the current location of a Google Find My device."
  target:
    entity:
      domain: device_tracker
    device: {}
    area: {}
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass an entity_id/canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy

play_sound:
  name: Play Sound
  description: "Play a sound on a Google Find My device."
  target:
    entity:
      domain: device_tracker
    device: {}
    area: {}
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass an entity_id/canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy

stop_sound:
  name: Stop Sound
  description: "Stop the sound on a Google Find My device."
  target:
    entity:
      domain: device_tracker
    device: {}
    area: {}
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass an entity_id/canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy

locate_external:
  name: Locate Device (External)
  description: "Request location via an external helper path (delegates to normal locate)."
  target:
    entity:
      domain: device_tracker
    device: {}
    area: {}
  fields:
    device_id:
      name: Device
      description: "Select a Google Find My device (or pass an entity_id/canonical ID via Developer Tools)."
      required: true
      selector:
        device:
          integration: googlefindmy
    device_name:
      name: Device Name
      description: "Optional friendly name used for logging only."
      example: "Keys Tracker"
      required: false
      selector:
        text:

refresh_device_urls:
  name: Refresh Device URLs
  description: "Recompute and update each device's configuration_url to point to the map view."

rebuild_registry:
  name: Rebuild / Migrate Registry
  description: "Maintenance: Perform a soft data→options migration or rebuild entities/devices for this integration."
  fields:
    mode:
      name: Mode
      description: "Choose 'Rebuild' (remove entities/devices and reload) or 'Migrate' (re-apply data→options only)."
      required: false
      default: rebuild
      selector:
        select:
          options:
            - label: Rebuild (remove + reload)
              value: rebuild
            - label: Migrate (data→options only)
              value: migrate
    device_ids:
      name: Devices (optional)
      description: "Limit operation to specific devices. Leave empty to target all Google Find My devices. (Selector passes HA device IDs.)"
      required: false
      selector:
        device:
          multiple: true
          integration: googlefindmy
